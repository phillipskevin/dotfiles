worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include mime.types;
    default_type application/octet-stream;
    sendfile on;
    keepalive_timeout 65;

#    server {
#      listen 3333;
#      server_name localhost;
#      root /Users/kevinphillips/dev/projects/cars/js-unit-testing-intro/src;
#    }

    #cms static code
    server {
        listen 80;
        server_name localhost 127.0.0.1;

        root /Users/kevinphillips/dev/projects/cars/www-cars-com-static/dist;

        location /static {
            alias /Users/kevinphillips/dev/projects/cars/www-cars-com-static/dist;
        }

        location /cs {
            proxy_pass http://localhost:9080;
        }

        location /cas {
            proxy_pass http://localhost:9080;
        }

        location /ajax/mvis/2.0/rest/dropDownData/suggestedSearch {
           proxy_pass http://localhost:9999;
        }

        location /ajax {
            proxy_pass https://www-dev01-03.cars.com;
        }

        location /profile {
            proxy_pass http://www-dev01-01.cars.com;
        }

        location /images {
            proxy_pass http://www-dev01-01.cars.com;
        }

        location /go {
            proxy_pass http://www-ft.cars.com;
        }

        location /for-sale {
            proxy_pass http://www-ft.cars.com;
        }

        rewrite ^/$ /cs/ContentServer?d=&pagename=HelloWorld;
        rewrite ^/articles/([^/]+)/?$ /cs/Sites?lookuphost=/&lookuppage=articles/$1;
        rewrite ^/alpha/([^/]+)/?$ /cs/Sites?lookuphost=/&lookuppage=alpha/$1;
        rewrite ^/news/$ /cs/Sites?lookuphost=/&lookuppage=news;
        rewrite ^/news/([^/]+)/?$ /cs/Sites?lookuphost=/&lookuppage=news/tag&tag=$1;
    }

    #m.cars
#    server {
#      listen 8080;
#      server_name localhost;
#      root /Users/kevinphillips/dev/projects/cars/m-cars-com-content/WebContent;
#
#      location /m/profile {
#        proxy_pass https://m.cars.com;
#      }
#
#      location /m {
#        proxy_pass http://m.cars.com;
#      }
#    }

    # cars.com
#    server {
#        listen 8080;
#        server_name localhost;
#        proxy_redirect off;
#        proxy_set_header Host $host;
#        proxy_set_header X-Real-IP $remote_addr;
#        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#
#        # example of running the profile app locally on port 8081 - uncomment and edit as needed for any apps you maybe running locally
#        location /profile {
#            proxy_pass http://127.0.0.1:8081;
#        }
#
#        # sell app pointed to https version of dev01-01 - edit to point at local if you're working on sell app
#        location /sell {
#            proxy_pass https://www-dev01-01.cars.com;
#        }
#
#        # repair and care - pointed to dev01-01  - edit to point at local if you're working on repair app
#        location /auto-repair {
#          proxy_pass http://www-dev01-01.cars.com;
#        }
#
#        location /for-sale {
#          proxy_pass http://www-dev01-01.cars.com;
#        }

#
#        location / {
#            proxy_pass http://CARS-KPHILLIPS.corp.classifiedventures.com;
#            root       html;
#            index      index.html index.htm;
#
#            # sections
#            rewrite ^/research/$ /go/core/jsp/researchIndex.jsp;
#            rewrite ^/advice/$ /go/core/jsp/adviceIndex.jsp;
#            rewrite ^/finance/$ /go/core/jsp/financeIndex.jsp;
#            rewrite ^/for-sale/$ /go/core/jsp/buyIndex.jsp;
#            rewrite ^/guides/(.*)$ /go/core/jsp/guides/controller.jsp?ruri=guides/$1;
#            rewrite ^/awards/(.*)$ /go/core/jsp/awards/controller.jsp?ruri=$1;
#            rewrite ^/marketplace/(.*)$ /go/marketplace/controller.jsp?ruri=$1;
#            rewrite ^/autoshows/(.*)$ /go/autoshows/controller.jsp?ruri=$1;
#            rewrite ^/about/(.*)$ /go/core/jsp/about/controller.jsp?ruri=$1;
#            rewrite ^/new-cars/$ /go/core/jsp/newCarsIndex.jsp;
#            rewrite ^/used-cars/$ /go/core/jsp/usedCarsIndex.jsp;
#
#            # search - new rules
#            rewrite ^/(acura|alfa-romeo|am-general|aston-martin|audi|bmw|bentley|bugatti|buick|cadillac|chevrolet|chrysler|daewoo|daihatsu|dodge|eagle|ferrari|fiat|fisker|ford|gmc|general-motors|geo|honda|hummer|hyundai|infiniti|international|isuzu|jaguar|jeep|kia|koenigsegg|lamborghini|land-rover|lexus|lincoln|lotus|maserati|maybach|mazda|mercedes-benz|mercury|mini|mitsubishi|morgan|nissan|oldsmobile|panoz|peugeot|plymouth|pontiac|porsche|ram|rolls-royce|saab|saleen|saturn|scion|smart|spyker|sterling|subaru|suzuki|tata|tesla|think|toyota|volkswagen|volvo|yugo)/$ /go/crp/seo_make.jsp?make=$1;
#            rewrite ^/(acura|alfa-romeo|am-general|aston-martin|audi|bmw|bentley|bugatti|buick|cadillac|chevrolet|chrysler|daewoo|daihatsu|dodge|eagle|ferrari|fiat|fisker|ford|gmc|general-motors|geo|honda|hummer|hyundai|infiniti|international|isuzu|jaguar|jeep|kia|koenigsegg|lamborghini|land-rover|lexus|lincoln|lotus|maserati|maybach|mazda|mercedes-benz|mercury|mini|mitsubishi|morgan|nissan|oldsmobile|panoz|peugeot|plymouth|pontiac|porsche|ram|rolls-royce|saab|saleen|saturn|scion|smart|spyker|sterling|subaru|suzuki|tata|tesla|think|toyota|volkswagen|volvo|yugo)/([^/]+)/$ /go/crp/seo_model.jsp?make=$1&model=$2;
#            rewrite "^/(acura|alfa-romeo|am-general|aston-martin|audi|bmw|bentley|bugatti|buick|cadillac|chevrolet|chrysler|daewoo|daihatsu|dodge|eagle|ferrari|fiat|fisker|ford|gmc|general-motors|geo|honda|hummer|hyundai|infiniti|international|isuzu|jaguar|jeep|kia|koenigsegg|lamborghini|land-rover|lexus|lincoln|lotus|maserati|maybach|mazda|mercedes-benz|mercury|mini|mitsubishi|morgan|nissan|oldsmobile|panoz|peugeot|plymouth|pontiac|porsche|ram|rolls-royce|saab|saleen|saturn|scion|smart|spyker|sterling|subaru|suzuki|tata|tesla|think|toyota|volkswagen|volvo|yugo)/([^/]+)/(\d{4})/$" /go/core/jsp/vehicle-research/controller.jsp?ruri=$1/$2/$3;
#            rewrite "^/(acura|alfa-romeo|am-general|aston-martin|audi|bmw|bentley|bugatti|buick|cadillac|chevrolet|chrysler|daewoo|daihatsu|dodge|eagle|ferrari|fiat|fisker|ford|gmc|general-motors|geo|honda|hummer|hyundai|infiniti|international|isuzu|jaguar|jeep|kia|koenigsegg|lamborghini|land-rover|lexus|lincoln|lotus|maserati|maybach|mazda|mercedes-benz|mercury|mini|mitsubishi|morgan|nissan|oldsmobile|panoz|peugeot|plymouth|pontiac|porsche|ram|rolls-royce|saab|saleen|saturn|scion|smart|spyker|sterling|subaru|suzuki|tata|tesla|think|toyota|volkswagen|volvo|yugo)/([^/]+)/(\d{4})/([^/]*)" /go/core/jsp/vehicle-research/controller.jsp?ruri=$1/$2/$3/$4;
#
#            # here are some old search rules I'd written to be more generic than the above ...
#            # keeping these commented here for posterity but you're probably better off with the specific rules above
#            #rewrite "!/for-sale/[^/]+/[^/]+/.{2}/[^/]+" /go/search/controller.jsp?ruri=$request_uri;
#            #rewrite "^/([^/]+)/([^/]+)/(\d{4})/([^/]*)" /go/core/jsp/vehicle-research/controller.jsp?ruri=$request_uri break;
#            #rewrite ^/([^/]+)/$ /go/crp/seo_make.jsp?make=$1;
#            #rewrite ^/([^/]+)/([^/]+)/$ /go/crp/seo_model.jsp?make=$1&model=$2;
#            #rewrite "^/([^/]+)/([^/]+)/(\d{4})/([^/]*)" /go/crp/research.jsp?make=$1&model=$2&year=$3&section=$4;
#
#            # dealer reviews
#            rewrite ^/dealers/reviews/?.* /go/dealers/reviews/index.jsp;
#            rewrite ^/dealers/reviews/(\d+)/$ /dealers/redirectReviews?dlId=$1;
#            rewrite ^/dealers/reviews/(\d+)/write-review/ /dealers/userReview.action?dlId=$1;
#
#            # mobile
#            rewrite ^/mobile /go/core/jsp/mobileIndex.jsp?pagename=$request_uri;
#
#            # cache buster
#            rewrite "/\d{4}\.\d{2}\.\d{2}/(.*)" /go/$1;
#
#            # go resources
#            rewrite ^/(?!go/)(.+)\.(js|css|gif|jpg|png|ejs|json|html|txt|woff|svg|ttf|otf|ico|mustache)$ /go/$1.$2;
#
#            # index page
#            rewrite ^/$ /go/core/jsp/index.jsp;
#        }
#
#        error_page 500 502 503 504 /50x.html;
#        location = /50x.html {
#            root html;
#        }
#    }
}
